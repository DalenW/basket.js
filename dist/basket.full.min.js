/*!
* <%= pkg.name %>
* v<%= pkg.version %> - <%= grunt.template.today("yyyy-mm-dd") %>
<%= pkg.homepage ? "* " + pkg.homepage + "\n" : "" %>* (c) <%= pkg.author.name %>; <%= _.pluck(pkg.licenses, "type").join(", ") %> License
* Created by: <%= _.pluck(pkg.maintainers, "name").join(", ") %>
* Contributors: <%= _.pluck(pkg.contributors, "name").join(", ") %>
* Uses rsvp.js, https://github.com/tildeio/rsvp.js
*/
(function(){"use strict";function c(t){return"function"==typeof t}var t=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},h=t,r=Date.now||function(){return(new Date).getTime()};function e(){}var n=Object.create||function(t){if(1<arguments.length)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return e.prototype=t,new e};function o(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function i(t){return t._promiseCallbacks||(t._promiseCallbacks={})}var u={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,e){if("function"!=typeof e)throw new TypeError("Callback must be a function");var n=i(this),r=n[t];-1===o(r=r||(n[t]=[]),e)&&r.push(e)},off:function(t,e){var n,r=i(this);e?-1!==(e=o(n=r[t],e))&&n.splice(e,1):r[t]=[]},trigger:function(t,e){var n;if(n=i(this)[t])for(var r=0;r<n.length;r++)(0,n[r])(e)}},s={instrument:!1};function a(t,e){if("onerror"!==t)return 2!==arguments.length?s[t]:void(s[t]=e);s.on("error",e)}u.mixin(s);var l=[];var f=function(t,e,n){1===l.push({name:t,payload:{key:e._guidKey,id:e._id,eventName:t,detail:e._result,childId:n&&n._id,label:e._label,timeStamp:r(),error:s["instrument-with-stack"]?new Error(e._label):null}})&&setTimeout(function(){for(var t,e=0;e<l.length;e++){var n=(t=l[e]).payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),s.trigger(t.name,t.payload)}l.length=0},50)};function d(){}var p=void 0,y=1,v=2,_=new S;function m(t,r,o){s.async(function(e){var n=!1,t=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(o,r,function(t){n||(n=!0,(r!==t?w:k)(e,t))},function(t){n||(n=!0,E(e,t))},e._label);!n&&t&&(n=!0,E(e,t))},t)}function g(t,e){var n,r,o;e.constructor===t.constructor?(r=t,(o=e)._state===y?k(r,o._result):o._state===v?(o._onError=null,E(r,o._result)):C(o,void 0,function(t){(o!==t?w:k)(r,t)},function(t){E(r,t)})):(n=function(t){try{return t.then}catch(t){return _.error=t,_}}(e))===_?E(t,_.error):void 0!==n&&c(n)?m(t,e,n):k(t,e)}function w(t,e){var n;(t!==e&&("function"==typeof(n=e)||"object"==typeof n&&null!==n)?g:k)(t,e)}function b(t){t._onError&&t._onError(t._result),x(t)}function k(t,e){t._state===p&&(t._result=e,t._state=y,0===t._subscribers.length?s.instrument&&f("fulfilled",t):s.async(x,t))}function E(t,e){t._state===p&&(t._state=v,t._result=e,s.async(b,t))}function C(t,e,n,r){var o=t._subscribers,i=o.length;t._onError=null,o[i]=e,o[i+y]=n,o[i+v]=r,0===i&&t._state&&s.async(x,t)}function x(t){var e=t._subscribers,n=t._state;if(s.instrument&&f(n===y?"fulfilled":"rejected",t),0!==e.length){for(var r,o,i=t._result,u=0;u<e.length;u+=3)r=e[u],o=e[u+n],r?A(n,r,o,i):o(i);t._subscribers.length=0}}function S(){this.error=null}var T=new S;function A(t,e,n,r){var o,i,u,a,s=c(n);if(s){if((o=function(t,e){try{return t(e)}catch(t){return T.error=t,T}}(n,r))===T?(a=!0,i=o.error,o=null):u=!0,e===o)return void E(e,new TypeError("A promises callback cannot return that same promise."))}else o=r,u=!0;e._state!==p||(s&&u?w(e,o):a?E(e,i):t===y?k(e,o):t===v&&E(e,o))}function j(t,e,n){return t===y?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function O(t,e,n,r){var o=this;o._instanceConstructor=t,o.promise=new t(d,r),o._abortOnReject=n,o._validateInput(e)?(o._input=e,o.length=e.length,o._remaining=e.length,o._init(),0===o.length?k(o.promise,o._result):(o.length=o.length||0,o._enumerate(),0===o._remaining&&k(o.promise,o._result))):E(o.promise,o._validationError())}var I=O;O.prototype._validateInput=function(t){return h(t)},O.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},O.prototype._init=function(){this._result=new Array(this.length)},O.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,r=0;e._state===p&&r<t;r++)this._eachEntry(n[r],r)},O.prototype._eachEntry=function(t,e){var n,r=this,o=r._instanceConstructor;"object"==typeof(n=t)&&null!==n?t.constructor===o&&t._state!==p?(t._onError=null,r._settledAt(t._state,e,t._result)):r._willSettleAt(o.resolve(t),e):(r._remaining--,r._result[e]=r._makeResult(y,e,t))},O.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===p&&(r._remaining--,r._abortOnReject&&t===v?E(o,n):r._result[e]=r._makeResult(t,e,n)),0===r._remaining&&k(o,r._result)},O.prototype._makeResult=function(t,e,n){return n},O.prototype._willSettleAt=function(t,e){var n=this;C(t,void 0,function(t){n._settledAt(y,e,t)},function(t){n._settledAt(v,e,t)})};var R=function(t,e){return new I(this,t,!0,e).promise};var N=function(t,e){var n=new this(d,e);if(!h(t))return E(n,new TypeError("You must pass an array to race.")),n;var r=t.length;function o(t){w(n,t)}function i(t){E(n,t)}for(var u=0;n._state===p&&u<r;u++)C(this.resolve(t[u]),void 0,o,i);return n};var D=function(t,e){return t&&"object"==typeof t&&t.constructor===this?t:(w(e=new this(d,e),t),e)};var P=function(t,e){return E(e=new this(d,e),t),e},M="rsvp_"+r()+"-",q=0;function U(t,e){var n=this;n._id=q++,n._label=e,n._state=void 0,n._result=void 0,n._subscribers=[],s.instrument&&f("created",n),d!==t&&(c(t)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),n instanceof U||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(e,t){var n=!1;try{t(function(t){n||(n=!0,w(e,t))},function(t){n||(n=!0,E(e,t))})}catch(t){E(e,t)}}(n,t))}var V=U;function H(t,e,n){this._superConstructor(t,e,!1,n)}U.cast=D,U.all=R,U.race=N,U.resolve=D,U.reject=P,U.prototype={constructor:U,_guidKey:M,_onError:function(t){var e=this;s.after(function(){e._onError&&s.trigger("error",t)})},then:function(t,e,n){var r=this,o=r._state;if(o===y&&!t||o===v&&!e)return s.instrument&&f("chained",r,r),r;r._onError=null;var i,u=new r.constructor(d,n),a=r._result;return s.instrument&&f("chained",r,u),o?(i=arguments[o-1],s.async(function(){A(o,u,i,a)})):C(r,u,t,e),u},catch:function(t,e){return this.then(void 0,t,e)},finally:function(e,t){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})},t)}},(H.prototype=n(I.prototype))._superConstructor=I,H.prototype._makeResult=j,H.prototype._validationError=function(){return new Error("allSettled must be called with an array")};function L(t,e){return new H(V,t,e).promise}function Y(t,e){return V.all(t,e)}var G,J=0;function K(t,e){ot[J]=t,ot[J+1]=e,2===(J+=2)&&$()}var B="undefined"!=typeof window?window:void 0,F=B||{},Q=F.MutationObserver||F.WebKitMutationObserver,W="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),t="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function X(){return function(){setTimeout(it,1)}}var $,z,Z,tt,et,nt,rt,ot=new Array(1e3);function it(){for(var t=0;t<J;t+=2)(0,ot[t])(ot[t+1]),ot[t]=void 0,ot[t+1]=void 0;J=0}$=W?(nt=process.nextTick,rt=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/),Array.isArray(rt)&&"0"===rt[1]&&"10"===rt[2]&&(nt=setImmediate),function(){nt(it)}):Q?(Z=0,tt=new Q(it),et=document.createTextNode(""),tt.observe(et,{characterData:!0}),function(){et.data=Z=++Z%2}):t?((z=new MessageChannel).port1.onmessage=it,function(){z.port2.postMessage(0)}):(void 0===B&&"function"==typeof require?function(){try{var t=require("vertx");return G=t.runOnLoop||t.runOnContext,function(){G(it)}}catch(t){return X()}}:X)();R=function(t){var n={};return n.promise=new V(function(t,e){n.resolve=t,n.reject=e},t),n};N=function(t,n,r){return V.all(t,r).then(function(o){if(!c(n))throw new TypeError("You must pass a function as filter's second argument.");for(var i=o.length,t=new Array(i),e=0;e<i;e++)t[e]=n(o[e]);return V.all(t,r).then(function(t){for(var e=new Array(i),n=0,r=0;r<i;r++)t[r]&&(e[n]=o[r],n++);return e.length=n,e})})};function ut(t,e,n){this._superConstructor(t,e,!0,n)}var at=ut;function st(t,e,n){this._superConstructor(t,e,!1,n)}(ut.prototype=n(I.prototype))._superConstructor=I,ut.prototype._init=function(){this._result={}},ut.prototype._validateInput=function(t){return t&&"object"==typeof t},ut.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},ut.prototype._enumerate=function(){var t,e=this.promise,n=this._input,r=[];for(t in n)e._state===p&&Object.prototype.hasOwnProperty.call(n,t)&&r.push({position:t,entry:n[t]});var o,i=r.length;this._remaining=i;for(var u=0;e._state===p&&u<i;u++)o=r[u],this._eachEntry(o.entry,o.position)},(st.prototype=n(at.prototype))._superConstructor=I,st.prototype._makeResult=j,st.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};D=function(t,e){return new st(V,t,e).promise};P=function(t,e){return new at(V,t,e).promise};M=function(t,o,i){return V.all(t,i).then(function(t){if(!c(o))throw new TypeError("You must pass a function as map's second argument.");for(var e=t.length,n=new Array(e),r=0;r<e;r++)n[r]=o(t[r]);return V.all(n,i)})};function ct(){this.value=void 0}var lt=new ct,ft=new ct;function pt(t,e,n){try{t.apply(e,n)}catch(t){return lt.value=t,lt}}F=function(f,p){function t(){for(var t,e=arguments.length,n=new Array(e+1),r=!1,o=0;o<e;++o){if(t=arguments[o],!r){if((r=!(!(i=t)||"object"!=typeof i)&&(i.constructor===V||function(t){try{return t.then}catch(t){return lt.value=t,lt}}(i)))===ft){var i=new V(d);return E(i,ft.value),i}r&&!0!==r&&(t=function(n,r){return{then:function(t,e){return n.call(r,t,e)}}}(r,t))}n[o]=t}var u,a,s,c,l=new V(d);return n[e]=function(t,e){t?E(l,t):void 0===p?w(l,e):!0===p?w(l,function(t){for(var e=t.length,n=new Array(e-1),r=1;r<e;r++)n[r-1]=t[r];return n}(arguments)):h(p)?w(l,function(t,e){for(var n,r={},o=t.length,i=new Array(o),u=0;u<o;u++)i[u]=t[u];for(n=0;n<e.length;n++)r[e[n]]=i[n+1];return r}(arguments,p)):w(l,e)},r?(u=l,a=n,s=f,c=this,V.all(a).then(function(t){t=pt(s,c,t);return t===lt&&E(u,t.value),u})):function(t,e,n,r){e=pt(n,r,e);e===lt&&E(t,e.value);return t}(l,n,f,this)}return t.__proto__=f,t};if("object"==typeof self)ht=self;else{if("object"!=typeof global)throw new Error("no global: `self` or `global` found");ht=global}W=ht;t=function(t,e){return V.race(t,e)};B=function(t,e){return V.reject(t,e)};n=function(t,e){return V.resolve(t,e)};var ht=function(t){throw setTimeout(function(){throw t}),t};s.async=K,s.after=function(t){setTimeout(t,0)};function dt(){s.on.apply(s,arguments)}if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var yt,vt=window.__PROMISE_INSTRUMENTATION__;for(yt in a("instrument",!0),vt)vt.hasOwnProperty(yt)&&dt(yt,vt[yt])}var _t={race:t,Promise:V,allSettled:L,hash:P,hashSettled:D,denodeify:F,on:dt,off:function(){s.off.apply(s,arguments)},map:M,filter:N,resolve:n,reject:B,all:Y,rethrow:ht,defer:R,EventTarget:u,configure:a,async:function(t,e){s.async(t,e)}};"function"==typeof define&&define.amd?define(function(){return _t}):"undefined"!=typeof module&&module.exports?module.exports=_t:void 0!==W&&(W.RSVP=_t)}).call(this),function(t,n){"use strict";const r=n.head||n.getElementsByTagName("head")[0];var o="basket-";let i=5e3,u=[],a=!1,s="",c=!1;const l=function(n,r){try{return localStorage.setItem(o+n,JSON.stringify(r)),!0}catch(t){if(0<=t.name.toUpperCase().indexOf("QUOTA")){let t,e=[];for(t in localStorage)0===t.indexOf(o)&&e.push(JSON.parse(localStorage[t]));return e.length?(e.sort(function(t,e){return t.stamp-e.stamp}),basket.remove(e[0].key),l(n,r)):void 0}return}};function f(r){return o=r.url,c&&console.log("Basket Getting URL: "+o+", global skipCDNCache is: "+a.toString()),new RSVP.Promise(function(t,e){const n=new XMLHttpRequest;n.open("GET",o),n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status&&n.responseText?t({content:n.responseText,type:n.getResponseHeader("content-type")}):e(new Error(n.statusText)))},setTimeout(function(){n.readyState<4&&n.abort()},basket.timeout),n.send()}).then(function(t){var e,n,e=(e=r,n=t,t=+new Date,e.data=n.content,e.originalType=n.type,e.type=e.type||n.type,e.skipCache=e.skipCache||!1,e.stamp=t,e.expire=t+60*(e.expire||i)*60*1e3,e);return r.skipCache||(c&&console.log("Adding to local storage with key "+r.key),l(r.key,e)),e});var o}function p(t){let e,n,r;var o,i;if(t.url)return t.key=t.key||t.url,void 0===t.skipCDNCache&&(t.skipCDNCache=a),t.skipCDNCache&&(""===s?t.url=t.url+"?_="+Math.random().toString(36).substr(2,5):t.url=t.url+"?_="+s),c&&console.log("Object URL is: "+t.url+" | Obj skipCDNCache is: "+t.skipCDNCache),e=basket.get(t.key),t.execute=!1!==t.execute,r=(o=e,i=t,!o||o.expire-+new Date<0||i.unique!==o.unique||basket.isValidItem&&!basket.isValidItem(o,i)),t.live||r?(t.unique&&(t.url+=(0<t.url.indexOf("?")?"&":"?")+"basket-unique="+t.unique),n=f(t),t.live&&!r&&(n=n.then(function(t){return t},function(){return e}))):(e.type=t.type||e.originalType,e.execute=t.execute,n=new RSVP.Promise(function(t){t(e)})),n}const h={default:function(t){const e=n.createElement("script");e.defer=!0,e.text=t.data,r.appendChild(e)}};function d(t){return t.map(function(t){var e;return t.execute&&((e=t).type&&h[e.type]?h[e.type](e):h.default(e)),t})}function y(){let t,e,n=[];for(t=0,e=arguments.length;t<e;t++)n.push(p(arguments[t]));return RSVP.all(n)}const v=function(){var t=y.apply(null,arguments);const e=this.then(function(){return t}).then(d);return e.thenRequire=v,e};t.basket={require:function(){for(var t=0,e=arguments.length;t<e;t++)arguments[t].execute=!1!==arguments[t].execute,arguments[t].once&&0<=u.indexOf(arguments[t].url)?arguments[t].execute=!1:!1!==arguments[t].execute&&u.indexOf(arguments[t].url)<0&&u.push(arguments[t].url);const n=y.apply(null,arguments).then(d);return n.thenRequire=v,n},remove:function(t){return localStorage.removeItem(o+t),this},get:function(t){var e=localStorage.getItem(o+t);try{return JSON.parse(e||"false")}catch(t){return!1}},clear:function(t){let e,n;var r=+new Date;for(e in localStorage)n=e.split(o)[1],n&&(!t||this.get(n).expire<=r)&&this.remove(n);return this},isValidItem:null,timeout:5e3,addHandler:function(t,e){(t=!Array.isArray(t)?[t]:t).forEach(function(t){h[t]=e})},removeHandler:function(t){basket.addHandler(t,void 0)},setDefaultExpiration:function(t){t=parseInt(t);return 1<=t?(i=t,!0):(console.log("Incorrect default expiration hours set."),!1)},getDefaultExpiration:function(){return i},setSkipCDNCache:function(t){return a=!0===t,a},setCacheInstance:function(t){return s=t,s},getCacheInstance:function(){return s},enableDebug:function(t){return c=!0===t,c}},basket.clear(!0)}(this,document);
//# sourceMappingURL=basket.full.min.js.map